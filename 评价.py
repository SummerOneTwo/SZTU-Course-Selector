import os
import re

import requests

from Code.Auth import Auth

s = requests.Session()
requests.packages.urllib3.disable_warnings()
def Cookie(_account_, _password_):
    a=Auth()
    mcookie = a.login(_account_, _password_)
    return mcookie,a
def pingjiao(cookie):
    d = "pj0502id=07A2724F03AD493BBE6D2CE1FF0885BD&pj01id=DAB7711074504CB78CEBC24B81B476BC&xnxq01id=2022-2023-1"
    z = "pj0502id=B90A0F587962404A84BB8EE4DF7AA0B0&pj01id=027FE7F08B0C4491AD78E2236073769F&xnxq01id=2022-2023-1"
    url = "https://jwxt.sztu.edu.cn/jsxsd/xspj/xspj_list.do?"
    headers = {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
        "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,zh-TW;q=0.5",
        "sec-ch-ua": "\"Microsoft Edge\";v=\"107\", \"Chromium\";v=\"107\", \"Not=A?Brand\";v=\"24\"",
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": "\"Windows\"",
        "sec-fetch-dest": "iframe",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "sec-fetch-user": "?1",
        "upgrade-insecure-requests": "1",
        "referrer": "https://jwxt.sztu.edu.cn/jsxsd/xspj/xspj_find.do",
        "Cookie": cookie
    }
    res = s.get(url=url + d, headers=headers, verify=False)
    ex = '<a href="/jsxsd/xspj/xspj_edit.do\?(.*?)">'
    a = re.findall(ex, res.text)  # 找出src 和alt  返回元组
    print(a)
    for item in a:
        savedod(item, cookie)
    res = s.get(url=url + z, headers=headers, verify=False)
    a = re.findall(ex, res.text)  # 找出src 和alt  返回元组
    print(a)
    for item in a:
        savedoz(item, cookie)
def savedod(item, cookie):
    url = "https://jwxt.sztu.edu.cn/jsxsd/xspj/xspj_save.do"
    headers = {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
        "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,zh-TW;q=0.5",
        "cache-control": "max-age=0",
        "content-type": "application/x-www-form-urlencoded",
        "sec-ch-ua": "\"Microsoft Edge\";v=\"107\", \"Chromium\";v=\"107\", \"Not=A?Brand\";v=\"24\"",
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": "\"Windows\"",
        "sec-fetch-dest": "iframe",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "sec-fetch-user": "?1",
        "upgrade-insecure-requests": "1",
        "referer": "https://jwxt.sztu.edu.cn/jsxsd/xspj/xspj_edit.do?" + item,
        "Cookie": cookie
    }
    datad = "issubmit=0&pj09id=ED66914E67A53D0FE053E2480B0A5682&pj02id=B6B259369D8B481BAC807DAD70D2351C&pj06xh=7&pj0601id_7=8DE160D7D7B5476C8739E853AA837435&pj0601fz_7_8DE160D7D7B5476C8739E853AA837435=0.2&pj0601fz_7_818F9A2206E14DE9BBB9D712D39266B9=0.4&pj0601fz_7_3C6C6205FEEE42718ECF44DD6B5818FF=0.6&pj0601fz_7_B49619F6600F41EEBE633EF3AF3779BE=0.8&pj0601fz_7_16DF23B2592F457BB15147232C52DCC0=1&pj06xh=8&pj0601id_8=1481D046357C4B41A8CA0F40A2C31D72&pj0601fz_8_1481D046357C4B41A8CA0F40A2C31D72=0.2&pj0601fz_8_D63FAFE1D7A043A881D82E9475DEC25D=0.4&pj0601fz_8_F79BEF77211D4908BABF1FCFE912839A=0.6&pj0601fz_8_EA6D4168923E4CEC909FD2498584E003=0.8&pj0601fz_8_00418C06208F405A94C1E88E88CB53C8=1&pj06xh=4&pj0601id_4=81B17E748F2741B1942EDE798C8E86F7&pj0601fz_4_81B17E748F2741B1942EDE798C8E86F7=0.2&pj0601fz_4_5B5C9B3BC5B543CDBFC69AF9DA516F50=0.4&pj0601fz_4_9447F2EA527B472CA35750723EBD31F2=0.6&pj0601fz_4_69CE5A876F22486DA857F9A1894887D1=0.8&pj0601fz_4_1B076799E4EB4BE88AB42A0655380AF7=1&pj06xh=2&pj0601id_2=F23E4A850E9A4324B00E4182DCC14A24&pj0601fz_2_F23E4A850E9A4324B00E4182DCC14A24=0.2&pj0601fz_2_B8F745D6E31B4EC5958D8EB768F09B52=0.4&pj0601fz_2_44A5BB68FBB34A839904015EECED8B04=0.6&pj0601fz_2_9544CE1338CD4DAA9A1EA5FFC8A06DBF=0.8&pj0601fz_2_19680435D0B346ABA6E630A313C86358=1&pj06xh=1&pj0601id_1=8CC1D31FB2D04803B4CAE06B7E0C7711&pj0601fz_1_8CC1D31FB2D04803B4CAE06B7E0C7711=0.2&pj0601fz_1_AB0EA72F1DC94094907D53CB43951A2D=0.4&pj0601fz_1_EDB4E195DE2146B88AA42D8D23049FC9=0.6&pj0601fz_1_6371FBF7DBE74518A3F29A5BEB526B6E=0.8&pj0601fz_1_857F9FCC95EE49BB9899AB70D395E845=1&pj06xh=3&pj0601id_3=9A4BF1D50ED24657B7E63D9BF2261778&pj0601fz_3_9A4BF1D50ED24657B7E63D9BF2261778=0.2&pj0601fz_3_B69FB13F0D474C11A2F5CC36E8F5A8BA=0.4&pj0601fz_3_5D35DEA154B549EB99A3A40A68F1EED6=0.6&pj0601fz_3_E176006962EE4DC581DE8FC2340E6BDD=0.8&pj0601fz_3_C8E2DFBEB3CD437293AC3CE15397E0E4=1&pj06xh=6&pj0601fz_6_9C165446C3944FC18EFCF3343616FFCC=0.21&pj0601id_6=D1B81754C13C4174B273567AF4190F46&pj0601fz_6_D1B81754C13C4174B273567AF4190F46=0.62&pj0601fz_6_F50457AF057E483E83949D6576B5C699=0.62&pj06xh=5&pj0601id_5=275D79EBD14E4A55A5D3806526340B86&pj0601fz_5_275D79EBD14E4A55A5D3806526340B86=0.19&pj0601fz_5_1AD910878BBA49FC89A9CDE7B4044CF5=0.77&pj03id=81FFD03DC89E49AE8CFE3A6767390182&jynr=&isxtjg=1"
    datad = datad + item
    res = s.post(url=url, headers=headers, data=datad)
    if "保存成功" in res.text:
        print("成功")
    else:
        print(res.text)
def savedoz(item, cookie):
    url = "https://jwxt.sztu.edu.cn/jsxsd/xspj/xspj_save.do"
    headers = {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
        "accept-language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6,zh-TW;q=0.5",
        "cache-control": "max-age=0",
        "content-type": "application/x-www-form-urlencoded",
        "sec-ch-ua": "\"Microsoft Edge\";v=\"107\", \"Chromium\";v=\"107\", \"Not=A?Brand\";v=\"24\"",
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": "\"Windows\"",
        "sec-fetch-dest": "iframe",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "sec-fetch-user": "?1",
        "upgrade-insecure-requests": "1",
        "referer": "https://jwxt.sztu.edu.cn/jsxsd/xspj/xspj_edit.do?" + item,
        "Cookie": cookie
    }
    dataz = "issubmit=0&pj09id=ED6695EE89413CFDE053E2480B0AEACA&pj02id=B6B259369D8B481BAC807DAD70D2351C&pj06xh=2&pj0601id_2=7BFA4B0E2DCC4F3F9C575A2582D6B9D6&pj0601fz_2_7BFA4B0E2DCC4F3F9C575A2582D6B9D6=4.89&pj0601fz_2_BE4EA5A4DA2044E49728CA7B4AE00F6C=3.91&pj0601fz_2_F8CBB325D36A4D108D3CFD1EB174D1DB=2.93&pj0601fz_2_00761FFC8F5F43B3A770CAA5695FEBB9=1.96&pj0601fz_2_26C0275D946E4E96AFA3E4E719E7F62E=0.98&pj06xh=3&pj0601id_3=AAA4C9B628C3488A86487AE355293CA6&pj0601fz_3_AAA4C9B628C3488A86487AE355293CA6=4.89&pj0601fz_3_058A82E782D440AB979932C05282EEE4=3.91&pj0601fz_3_3CB84ED526E74A66889A63EF7D923E42=2.93&pj0601fz_3_AD8F199BABF6454CA21C5A6072FC9FF2=1.96&pj0601fz_3_7629BE2C557F44F680644828869F57AC=0.98&pj06xh=14&pj0601id_14=16C8B37157CB4978A6662D1F1CC6CE82&pj0601fz_14_16C8B37157CB4978A6662D1F1CC6CE82=4.89&pj0601fz_14_3051DF1039E3405C86A6951683DC4C14=3.91&pj0601fz_14_70F8480325E24151886CECAE06A967D4=2.93&pj0601fz_14_B4B30B23F490400EB0795590DDD89E1C=1.96&pj0601fz_14_8841216ABDC94F5ABFC8D458FCB295E0=0.98&pj06xh=6&pj0601id_6=599E2F1C4D2043238F6B1A71C5B3A2B1&pj0601fz_6_599E2F1C4D2043238F6B1A71C5B3A2B1=4.89&pj0601fz_6_D5F4D6BBA59E41BD95D7B968EFD70684=3.91&pj0601fz_6_5BB580071C884EB798D7509CC9B2FC34=2.93&pj0601fz_6_44E4EA1F95214B558992D47D11D6D771=1.96&pj0601fz_6_BC6DF9FA55064F53B729AA8A261D1A86=0.98&pj06xh=16&pj0601id_16=3A1B2587B4EA454ABDF4A76A12F43C17&pj0601fz_16_3A1B2587B4EA454ABDF4A76A12F43C17=4.93&pj0601fz_16_25FD7EFAA24C483198271E7165D1559C=3.94&pj0601fz_16_2F2F2F0B7EE64276804C7E33A457F730=2.96&pj0601fz_16_B665135323784458BCD8A330D94ADE8F=1.97&pj0601fz_16_9A669E4323FF4A96A3C816F59D20841D=0.99&pj06xh=1&pj0601id_1=7DCC6FD0BFF84604B0B7866D40E51577&pj0601fz_1_7DCC6FD0BFF84604B0B7866D40E51577=4.93&pj0601fz_1_4B1C784810D343DFB256526F15F849FF=3.94&pj0601fz_1_2160F4E5D4E743E495025E9EFB5B7C4A=2.96&pj0601fz_1_5F47485B7E254074ABD8B5BEF7393F20=1.97&pj0601fz_1_86BBAF6FB7014E1B8C9755867AE660DD=0.99&pj06xh=4&pj0601id_4=753658C007B346728A401AD7F37507E9&pj0601fz_4_753658C007B346728A401AD7F37507E9=4.93&pj0601fz_4_720D73FA0BE24FFE9A66776E200FFCFC=3.94&pj0601fz_4_9056EA30E1F7439095C86136DDA5A2D8=2.96&pj0601fz_4_44D5AA6686D64494968AAA0A45FD7276=1.97&pj0601fz_4_878D57E43AD84696A961650434E19CE6=0.99&pj06xh=8&pj0601id_8=1A2A420B061247938DFED9D73DAA6D60&pj0601fz_8_1A2A420B061247938DFED9D73DAA6D60=4.93&pj0601fz_8_F440301EEE0B40BBA8EA9C0FFF94EE77=3.94&pj0601fz_8_99C7D68DE26340A2AA6DA8D4B576D9B4=2.96&pj0601fz_8_1C60D77C883D4D50BEEFEEE3B4C80BDA=1.97&pj0601fz_8_A547307A63A846B6941125545FBEC24D=0.99&pj06xh=15&pj0601id_15=FC6EFC3D9D93455698105B1ED243997A&pj0601fz_15_FC6EFC3D9D93455698105B1ED243997A=4.93&pj0601fz_15_AB91B082EBF3418B825956264A27A54A=3.94&pj0601fz_15_5EF25BD35F62428B8242480914FF466E=2.96&pj0601fz_15_BDB2DEA895DE4969BC991EE0B53A88D1=1.97&pj0601fz_15_3746297F64E84484801AA5512F646BDA=0.99&pj06xh=7&pj0601id_7=2997ADF8D09F4FD4837AD165417BB250&pj0601fz_7_2997ADF8D09F4FD4837AD165417BB250=5.1&pj0601fz_7_8CA6A8119F3B480A9EC4C0449E966E59=4.08&pj0601fz_7_BED7EF6F5CC947E9BFCF636879460C27=3.06&pj0601fz_7_D52F6AE02DF944E683FB4CE090BA789A=2.04&pj0601fz_7_FA6949AA46994DBAB7DFFF049933BD10=1.02&pj06xh=10&pj0601id_10=B024DADE57614164AE464E420191083F&pj0601fz_10_B024DADE57614164AE464E420191083F=5.1&pj0601fz_10_5114C39C69BB48CDB43DA5B572FE9B71=4.08&pj0601fz_10_54310384B8AC40E7B036E4F335AFE6FB=3.06&pj0601fz_10_54B38EB1CD434C06A89DAEA6A538054C=2.04&pj0601fz_10_812293A95D4541128551EF74912B70BA=1.02&pj06xh=11&pj0601id_11=40A78EFF9C1145E3B962A3300767CF53&pj0601fz_11_40A78EFF9C1145E3B962A3300767CF53=5.1&pj0601fz_11_78A07A657E174D9B9904A8C0B27E4EEE=4.08&pj0601fz_11_6661668C56814180986FECCFFE624059=3.06&pj0601fz_11_107563396953481B98365ED992C77F28=2.04&pj0601fz_11_3344000958FB4F9AA247E430D5EC8535=1.02&pj06xh=5&pj0601id_5=CE9B048EACD14F71871C8FFD7836910F&pj0601fz_5_CE9B048EACD14F71871C8FFD7836910F=5.1&pj0601fz_5_21E25E0DB7DD4D8B96EBE19BDC5FC38D=4.08&pj0601fz_5_AC1A7E7848434A06B782D0CA4AF99B2A=3.06&pj0601fz_5_2DAC8916FF2D47CA83C61A86DB1C5776=2.04&pj0601fz_5_C872F846AE664FDA9F9996214232D2B6=1.02&pj06xh=17&pj0601id_17=25A4527619FC4F31828B72C6F6E5777F&pj0601fz_17_25A4527619FC4F31828B72C6F6E5777F=5.1&pj0601fz_17_41057ED85C66425DAC721F0A71D5B81D=4.08&pj0601fz_17_D82C008258844508B1F71648B59F5006=3.06&pj0601fz_17_882EB4CABFC04853B815CFBEB3B2FEDE=2.04&pj0601fz_17_395857D14CFB49399113F0F176A5AC80=1.02&pj06xh=9&pj0601id_9=6A9ACCE152224381A09C3C9F61CD44DF&pj0601fz_9_6A9ACCE152224381A09C3C9F61CD44DF=5.1&pj0601fz_9_222C576A4A7B403C96B618907ED42037=4.08&pj0601fz_9_C897B0AAE0CD4462B661DA89936F744E=3.06&pj0601fz_9_9D52BFFCFA8A4317A8FD052B1D4773EF=2.04&pj0601fz_9_3662CAA4F1884790A2DB3D174FD8E629=1.02&pj06xh=13&pj0601id_13=84B8FD142E0248BCB9AA964368A44C32&pj0601fz_13_84B8FD142E0248BCB9AA964368A44C32=5.1&pj0601fz_13_01DC3E6B0EF1466A957215293F9A9037=4.08&pj0601fz_13_9F521C9295444E0487103F2B3A802CFE=3.06&pj0601fz_13_59B8620D6B5549D692DBE927DA592CD7=2.04&pj0601fz_13_38460D42EE5A46C89A952FC188B94B53=1.02&pj06xh=12&pj0601fz_12_02FC3088F5B544218FB20A6E7D00ECAF=5.1&pj0601id_12=9C769AC5D83E4FF381C1BC096C2C116C&pj0601fz_12_9C769AC5D83E4FF381C1BC096C2C116C=4.08&pj0601fz_12_BB8D53DD78A6448280A91922B900E822=3.06&pj0601fz_12_7627CFBF9A7E46D19EA564EF94CFF1DC=2.04&pj0601fz_12_FCB761C74BAD4465AD9E76191B8C4AA7=1.02&pj03id=81FFD03DC89E49AE8CFE3A6767390182&jynr=&isxtjg=1"
    dataz = dataz + item
    res = s.post(url=url, headers=headers, data=dataz)
    if "保存成功" in res.text:
        print("成功")
    else:
        print(res.text)
if __name__ == "__main__":

        user = input("用户名")
        pwd = input("密码")
        q,a = Cookie(user, pwd)
        pingjiao(q)

        os.system("pause")
