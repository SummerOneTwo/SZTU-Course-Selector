# SZTU 深圳技术大学教务系统自动选课脚本

这是一个用于深圳技术大学（SZTU）教务系统的自动化选课Python脚本。它通过模拟登录和API请求，帮助学生快速、自动地完成选课流程。

## 📢 重要声明

⚠️ **请仔细阅读并理解以下免责声明：**

*   **仅供学习和技术交流使用**，请勿用于非法用途或恶意攻击教务系统
*   使用此脚本存在**账号被系统暂时锁定**的风险，开发者不对任何可能产生的后果负责
*   请**低调使用**，避免对学校服务器造成过大负担
*   **风险自担**，使用前请确保你已充分了解并接受相关风险

## ✨ 主要功能

### 🔐 智能登录系统
*   **统一身份认证**：自动处理SZTU统一身份认证登录流程
*   **DES加密支持**：自动处理密码加密，确保登录安全性
*   **会话管理**：自动维护登录会话状态

### 🎯 高效选课机制
*   **多课程并发**：支持同时抢选多个课程，提高效率
*   **线程池优化**：使用线程池技术，可配置并发数（建议4-16个线程）
*   **智能重试**：失败课程自动进入下一轮重试，直到全部成功
*   **随机延时**：每轮间随机等待，避免被系统检测

### ⚙️ 灵活配置选项
*   **多种选课类型**：支持必修计划、跨年级选课等
*   **批次选择**：支持抽选、抢选、补选等不同阶段
*   **自定义参数**：可调整并发数、等待时间等高级参数
*   **数据校验**：配置文件自动校验，确保课程ID匹配

### 📊 实时状态反馈
*   **彩色日志**：清晰的控制台输出，实时显示登录和选课状态
*   **进度追踪**：显示每轮选课结果和剩余课程数量
*   **统计报告**：完成后显示总成功率和耗时统计

## 📋 系统要求

- **Python版本**：Python 3.6 或更高版本
- **操作系统**：Windows / macOS / Linux
- **网络环境**：能够访问深圳技术大学教务系统

## 📦 快速开始

### 1️⃣ 获取项目
```bash
git clone https://github.com/SummerOneTwo/SZTU-Course-Selector.git
cd SZTU-Course-Selector
```

### 2️⃣ 安装依赖
项目依赖以下Python包：
- `requests` - HTTP请求库
- `pycryptodome` - 加密解密库  
- `urllib3` - URL处理库

```bash
pip install -r requirements.txt
```

### 3️⃣ 配置信息
复制配置模板并填写信息：
```bash
# Windows 用户
copy config.txt.example config.txt

# macOS/Linux 用户  
cp config.txt.example config.txt
```

## ⚙️ 详细配置

### 📝 配置文件说明

编辑 `config.txt` 文件，配置你的选课信息：

```ini
[mysql]
# 你的统一身份认证用户名（学号）
username = 202xxxxxx
# 你的统一身份认证密码
password = your_password
# 选课类型: 0 代表"必选计划"，1 代表"跨年级选课"
cno = 0

# 课程ID和教学班ID，必须一一对应，用逗号隔开
# 重点：kcid 和 jx0404id 的数量必须完全相同！
kcid = S20210001,S20210002
jx0404id = 202120221S20210001001,202120221S20210002002

# 选课批次ID，每学期可能会更新
# 抽选: jx0502zbid = ACB71E3B9A2342BFB974665635465D21
# 抢选: jx0502zbid = 6F475A1E34A34C6DA840E9733BDED626  
# 补选: jx0502zbid = 248522AF977240AD868F3566F15CDED9
jx0502zbid = ACB71E3B9A2342BFB974665635465D21

[advanced]
# (高级) 并发线程数，建议范围 4-16，根据网络情况调整
max_workers = 8
# (高级) 每轮抢课失败后的随机等待时间范围（秒）
round_cool_down_min = 30
round_cool_down_max = 90
```

### 🔍 如何获取课程参数

**获取 `kcid` 和 `jx0404id`：**
1. **登录教务系统**：进入深圳技术大学教务系统选课页面
2. **打开开发者工具**：浏览器按 `F12`，切换到"Network"标签
3. **尝试选课**：点击想要选择课程的"选课"按钮
4. **查找请求**：找到类似 `knjxkOper` 或 `bxqjhxkOper` 的网络请求
5. **提取参数**：在请求的"Payload"中找到 `kcid` 和 `jx0404id` 参数

**获取 `jx0502zbid`（批次ID）：**
- 在选课页面URL中找到 `jx0502zbid=...` 参数
- 不同选课阶段使用不同的批次ID（详见配置文件说明）

### 📊 数据文件说明

项目包含 `选课数据.json` 文件，这是课程信息的完整数据库，包含：
- 课程编号、名称、学分信息
- 上课时间、地点安排  
- 教师信息、容量限制
- 可用于查询具体课程的详细信息

## 🚀 运行脚本

配置完成后，在项目目录中运行：

```bash
python sztu_course_selector.py
```

### 📱 运行流程
1. **配置校验**：检查配置文件格式和参数完整性
2. **登录认证**：自动登录SZTU统一身份认证系统
3. **进入选课系统**：跳转到教务系统选课模块
4. **开始选课**：使用多线程并发选课
5. **结果反馈**：实时显示选课进度和结果统计

### 🖥️ 输出示例
```
🔐 开始登录SZTU统一身份认证...
✅ 登录成功！用户: 202xxxxxx
🎯 进入选课系统...
🔥 第 1 轮抢课开始！目标课程数: 2
   (使用线程池，最大并发数: 8)
✅ 课程 S20210001 选课成功！
❌ 课程 S20210002 选课失败，加入重试列表
🏁 第 1 轮结束。本轮成功: 1 | 剩余: 1
🎉 全部完成！成功抢到 2/2 个课程！
总耗时: 1 分 23.45 秒
```

## 📁 项目结构

```
SZTU-Course-Selector/
├── sztu_course_selector.py    # 主程序文件
├── config.txt.example         # 配置文件模板
├── config.txt                 # 实际配置文件（需要自己创建）
├── requirements.txt           # Python依赖包
├── 选课数据.json              # 课程数据库文件
└── README.md                  # 项目说明文档
```

## ⚡ 使用技巧

### 🎯 提高成功率
- **合理设置并发数**：网络较好时可设置12-16，网络一般建议4-8
- **选择合适时间**：避开选课高峰期，如凌晨或早晨
- **准备充分**：提前获取准确的课程ID和批次ID

### 🔧 故障排除
- **登录失败**：检查用户名密码是否正确，账号是否被锁定
- **选课失败**：确认课程ID格式正确，批次ID是否过期
- **配置错误**：确保kcid和jx0404id数量一致，参数格式正确

## 📚 技术实现

### 🛠️ 核心技术
- **HTTP会话管理**：使用requests.Session维持登录状态
- **DES加密**：使用pycryptodome实现密码加密
- **多线程并发**：使用ThreadPoolExecutor提高选课效率
- **异常处理**：完善的错误处理和重试机制

### 🏗️ 架构设计
- **Auth类**：处理统一身份认证和会话管理
- **配置管理**：支持灵活的参数配置和校验
- **工作线程**：独立的选课工作线程，支持并发执行

## 🤝 贡献指南

欢迎为项目做出贡献！你可以：

- 🐛 **报告Bug**：发现问题请提交Issue
- 💡 **功能建议**：有好的想法欢迎讨论  
- 🔧 **代码贡献**：提交Pull Request改进代码
- 📖 **文档完善**：帮助改进文档和说明

### 贡献步骤
1. Fork 此仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 提交Pull Request

## ⚖️ 免责声明与许可

### 免责声明
- 本工具仅用于学习和研究目的，不得用于违反学校规定的行为
- 使用本工具造成的任何后果由使用者自行承担
- 开发者不对账号安全、选课结果或任何损失负责
- 请遵守学校的选课规定和系统使用条款

### 许可证
本项目基于 **MIT License** 开源协议发布。详情请参见 [LICENSE](LICENSE) 文件。

---

## 🌟 Star History

如果这个项目对你有帮助，请给个⭐Star支持一下！

---

**最后更新**：2025年9月11日  
**版本**：v1.0  
**作者**：SummerOneTwo

> 💡 **温馨提示**：使用前请仔细阅读学校选课相关规定，理性选课，诚信选课！
